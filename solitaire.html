<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ö–æ—Å—ã–Ω–∫–∞ –¥–ª—è –£–º–Ω–∏—á–∫–∏! üÉè</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <link
    href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Montserrat:wght@300;400;600&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="solitaire_style.css">
</head>

<body>
  <!-- –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ–Ω -->
  <div class="animated-bg">
    <div class="bg-shapes">
      <div class="shape shape-1"></div>
      <div class="shape shape-2"></div>
      <div class="shape shape-3"></div>
      <div class="shape shape-4"></div>
    </div>
  </div>

  <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏–≥—Ä—ã -->
  <div class="solitaire-container">
    <h1 class="game-title">–ö–æ—Å—ã–Ω–∫–∞ üÉè</h1>

    <div class="game-stats">
      <div class="stat-item">
        <div class="stat-value" id="moves">0</div>
        <div>–•–æ–¥—ã</div>
      </div>
      <div class="stat-item">
        <div class="stat-value" id="time">00:00</div>
        <div>–í—Ä–µ–º—è</div>
      </div>
      <div class="stat-item">
        <div class="stat-value" id="score">0</div>
        <div>–û—á–∫–∏</div>
      </div>
    </div>

    <div class="solitaire-game">
      <!-- –û—Ç–∫—Ä—ã—Ç–∞—è –∫–æ–ª–æ–¥–∞ –∏ –±–∞–∑–æ–≤—ã–µ —Å—Ç–æ–ø–∫–∏ -->
      <div class="top-row">
        <div class="deck-container">
          <div class="deck-placeholder" id="stock">
            <div class="card-back">üÉè</div>
          </div>
          <div class="deck-placeholder" id="waste"></div>
        </div>
        <div class="foundations">
          <div class="foundation" data-suit="hearts"></div>
          <div class="foundation" data-suit="diamonds"></div>
          <div class="foundation" data-suit="clubs"></div>
          <div class="foundation" data-suit="spades"></div>
        </div>
      </div>

      <!-- –ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ -->
      <div class="tableau" id="tableau">
        <!-- 7 –∫–æ–ª–æ–Ω–æ–∫ –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
      </div>
    </div>

    <div class="game-controls">
      <button class="game-button" id="hintButton">–ü–æ–¥—Å–∫–∞–∑–∫–∞ üí°</button>
      <button class="game-button" id="restartButton">–ó–∞–Ω–æ–≤–æ üîÑ</button>
      <button class="game-button" id="undoButton">–û—Ç–º–µ–Ω–∏—Ç—å ‚Ü©Ô∏è</button>
    </div>

    <a href="index.html" class="back-button">
      <i class="fas fa-arrow-left"></i> –í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞–∑–∞–¥
    </a>
  </div>

  <!-- –°–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–æ–º–ø–ª–∏–º–µ–Ω—Ç–æ–º -->
  <div class="compliment-message" id="complimentMessage">
    <div class="message-heart">üíñ</div>
    <h3 id="complimentText">–ú–æ–ª–æ–¥–µ—Ü! –¢—ã –ø—Ä–æ—Å—Ç–æ —É–º–Ω–∏—á–∫–∞! ‚ú®</h3>
  </div>

  <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ –ø–æ–±–µ–¥–µ -->
  <div class="win-message" id="winMessage" style="display: none;">
    <div class="message-heart">üéâ</div>
    <h2>–ü–æ–∑–¥—Ä–∞–≤–ª—è—é! –¢—ã –≤—ã–∏–≥—Ä–∞–ª–∞! üèÜ</h2>
    <p>–¢—ã —Å–æ–±—Ä–∞–ª–∞ –≤—Å—é –∫–æ—Å—ã–Ω–∫—É –∑–∞ <span id="winTime">00:00</span> –∏ <span id="winMoves">0</span> —Ö–æ–¥–æ–≤!</p>
    <button class="game-button" onclick="document.getElementById('winMessage').style.display='none'">
      –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∏–≥—Ä–∞—Ç—å
    </button>
  </div>

  <!-- –ü–ª–∞–≤–∞—é—â–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã -->
  <div class="floating-elements">
    <div class="floating-element fe-1">üíñ</div>
    <div class="floating-element fe-2">‚ú®</div>
    <div class="floating-element fe-3">üåü</div>
    <div class="floating-element fe-4">üéÄ</div>
    <div class="floating-element fe-5">üíï</div>
    <div class="floating-element fe-6">üÉè</div>
    <div class="floating-element fe-7">‚ô•Ô∏è</div>
    <div class="floating-element fe-8">‚ô†Ô∏è</div>
  </div>

  <script>
    class SolitaireGame {
      constructor() {
        this.suits = ['hearts', 'diamonds', 'clubs', 'spades'];
        this.ranks = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];
        this.deck = [];
        this.tableau = [[], [], [], [], [], [], []];
        this.foundations = { hearts: [], diamonds: [], clubs: [], spades: [] };
        this.stock = [];
        this.waste = [];
        this.selectedCards = [];
        this.moves = 0;
        this.score = 0;
        this.startTime = null;
        this.timerInterval = null;
        this.moveHistory = [];
        this.draggedCard = null;

        this.compliments = [
          "–ë–ª–µ—Å—Ç—è—â–µ! –¢—ã –Ω–∞—Å—Ç–æ—è—â–∏–π —Å—Ç—Ä–∞—Ç–µ–≥! ‚ô†Ô∏è",
          "–í–µ–ª–∏–∫–æ–ª–µ–ø–Ω—ã–π —Ö–æ–¥! –¢—ã —Å–ø—Ä–∞–≤–ª—è–µ—à—å—Å—è –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ! ‚ô•Ô∏è",
          "–ü–æ—Ç—Ä—è—Å–∞—é—â–µ! –£ —Ç–µ–±—è –æ—Ç–ª–∏—á–Ω–æ –ø–æ–ª—É—á–∞–µ—Ç—Å—è! ‚ô¶Ô∏è",
          "–ë—Ä–∞–≤–æ! –¢–≤–æ–∏ –Ω–∞–≤—ã–∫–∏ –≤–ø–µ—á–∞—Ç–ª—è—é—Ç! ‚ô£Ô∏è",
          "–ó–∞–º–µ—á–∞—Ç–µ–ª—å–Ω–æ! –¢—ã –Ω–∞—Ö–æ–¥–∏—à—å –ª—É—á—à–∏–µ —Ä–µ—à–µ–Ω–∏—è! üÉè",
          "–ò–¥–µ–∞–ª—å–Ω–æ! –¢—ã —Ä–æ–∂–¥–µ–Ω–∞ –¥–ª—è —ç—Ç–æ–π –∏–≥—Ä—ã! üí´",
          "–ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ! –¢–≤–æ—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑—É–ø—Ä–µ—á–Ω–æ! üåü",
          "–§–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞! –¢—ã –¥–µ–ª–∞–µ—à—å —ç—Ç–æ —Ç–∞–∫ –ª–µ–≥–∫–æ –∏ –∏–∑—è—â–Ω–æ! ‚ú®"
        ];

        this.init();
      }

      init() {
        this.createDeck();
        this.shuffleDeck();
        this.dealCards();
        this.renderGame();
        this.setupEventListeners();
        this.startTimer();
        this.updateStats();
      }

      createDeck() {
        this.deck = [];
        this.suits.forEach(suit => {
          this.ranks.forEach(rank => {
            this.deck.push({
              suit: suit,
              rank: rank,
              faceUp: false
            });
          });
        });
      }

      shuffleDeck() {
        for (let i = this.deck.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [this.deck[i], this.deck[j]] = [this.deck[j], this.deck[i]];
        }
      }

      dealCards() {
        // –†–∞–∑–¥–∞—á–∞ –∫–∞—Ä—Ç –≤ tableau
        let cardIndex = 0;
        for (let col = 0; col < 7; col++) {
          for (let row = 0; row <= col; row++) {
            const card = this.deck[cardIndex++];
            card.faceUp = (row === col); // –¢–æ–ª—å–∫–æ –≤–µ—Ä—Ö–Ω—è—è –∫–∞—Ä—Ç–∞ –æ—Ç–∫—Ä—ã—Ç–∞
            this.tableau[col].push(card);
          }
        }

        // –û—Å—Ç–∞–≤—à–∏–µ—Å—è –∫–∞—Ä—Ç—ã –∏–¥—É—Ç –≤ —Å—Ç–æ–∫
        this.stock = this.deck.slice(cardIndex);
      }

      renderGame() {
        this.renderStock();
        this.renderWaste();
        this.renderFoundations();
        this.renderTableau();
      }

      renderStock() {
        const stock = document.getElementById('stock');
        stock.innerHTML = this.stock.length > 0 ?
          '<div class="card-back">üÉè</div>' :
          '<div class="empty-placeholder"></div>';
      }

      renderWaste() {
        const waste = document.getElementById('waste');
        waste.innerHTML = '';

        if (this.waste.length > 0) {
          const topCard = this.waste[this.waste.length - 1];
          const cardElement = this.createCardElement(topCard, 'waste');
          waste.appendChild(cardElement);
        } else {
          waste.innerHTML = '<div class="empty-placeholder"></div>';
        }
      }

      renderFoundations() {
        this.suits.forEach(suit => {
          const foundation = document.querySelector(`.foundation[data-suit="${suit}"]`);
          foundation.innerHTML = '';

          const cards = this.foundations[suit];
          if (cards.length > 0) {
            const topCard = cards[cards.length - 1];
            const cardElement = this.createCardElement(topCard, 'foundation');
            foundation.appendChild(cardElement);
          } else {
            foundation.innerHTML = `<div class="empty-placeholder">${this.getSuitSymbol(suit)}</div>`;
          }
        });
      }

      renderTableau() {
        const tableau = document.getElementById('tableau');
        tableau.innerHTML = '';

        for (let col = 0; col < 7; col++) {
          const column = document.createElement('div');
          column.className = 'tableau-column';
          column.dataset.column = col;

          this.tableau[col].forEach((card, index) => {
            const cardElement = this.createCardElement(card, 'tableau', col, index);
            column.appendChild(cardElement);
          });

          tableau.appendChild(column);
        }
      }

      createCardElement(card, source, col = null, index = null) {
        const cardElement = document.createElement('div');
        cardElement.className = `card ${card.faceUp ? 'face-up' : 'face-down'} ${card.suit}`;
        cardElement.dataset.suit = card.suit;
        cardElement.dataset.rank = card.rank;
        cardElement.dataset.source = source;

        if (col !== null) cardElement.dataset.column = col;
        if (index !== null) cardElement.dataset.index = index;

        if (card.faceUp) {
          cardElement.innerHTML = `
            <div class="card-rank">${card.rank}</div>
            <div class="card-suit">${this.getSuitSymbol(card.suit)}</div>
          `;

          // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è
          this.addDragHandlers(cardElement);
        } else {
          cardElement.innerHTML = '<div class="card-back">üÉè</div>';
        }

        return cardElement;
      }

      addDragHandlers(cardElement) {
        cardElement.setAttribute('draggable', 'true');

        cardElement.addEventListener('dragstart', (e) => {
          this.draggedCard = cardElement;
          cardElement.classList.add('dragging');
          e.dataTransfer.setData('text/plain', '');
        });

        cardElement.addEventListener('dragend', () => {
          cardElement.classList.remove('dragging');
          document.querySelectorAll('.drop-zone').forEach(el => {
            el.classList.remove('drop-zone');
          });
        });
      }

      getSuitSymbol(suit) {
        const symbols = {
          'hearts': '‚ô•Ô∏è',
          'diamonds': '‚ô¶Ô∏è',
          'clubs': '‚ô£Ô∏è',
          'spades': '‚ô†Ô∏è'
        };
        return symbols[suit];
      }

      setupEventListeners() {
        // –ö–ª–∏–∫ –ø–æ —Å—Ç–æ–∫—É
        document.getElementById('stock').addEventListener('click', () => {
          this.dealFromStock();
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∑–æ–Ω —Å–±—Ä–æ—Å–∞
        this.setupDropZones();

        // –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        document.getElementById('hintButton').addEventListener('click', () => {
          this.showHint();
        });

        document.getElementById('restartButton').addEventListener('click', () => {
          this.restartGame();
        });

        document.getElementById('undoButton').addEventListener('click', () => {
          this.undoMove();
        });
      }

      setupDropZones() {
        // Foundations –∫–∞–∫ –∑–æ–Ω—ã —Å–±—Ä–æ—Å–∞
        document.querySelectorAll('.foundation').forEach(foundation => {
          foundation.addEventListener('dragover', (e) => {
            e.preventDefault();
            foundation.classList.add('drop-zone');
          });

          foundation.addEventListener('drop', (e) => {
            e.preventDefault();
            foundation.classList.remove('drop-zone');
            this.handleDrop(foundation, 'foundation');
          });

          foundation.addEventListener('dragleave', () => {
            foundation.classList.remove('drop-zone');
          });
        });

        // Tableau columns –∫–∞–∫ –∑–æ–Ω—ã —Å–±—Ä–æ—Å–∞
        document.getElementById('tableau').addEventListener('dragover', (e) => {
          e.preventDefault();
          const column = e.target.closest('.tableau-column');
          if (column) {
            column.classList.add('drop-zone');
          }
        });

        document.getElementById('tableau').addEventListener('drop', (e) => {
          e.preventDefault();
          const column = e.target.closest('.tableau-column');
          if (column) {
            column.classList.remove('drop-zone');
            this.handleDrop(column, 'tableau');
          }
        });

        document.getElementById('tableau').addEventListener('dragleave', (e) => {
          const column = e.target.closest('.tableau-column');
          if (column) {
            column.classList.remove('drop-zone');
          }
        });
      }

      handleDrop(target, targetType) {
        if (!this.draggedCard) return;

        const sourceType = this.draggedCard.dataset.source;
        const sourceCol = this.draggedCard.dataset.column;
        const sourceIndex = parseInt(this.draggedCard.dataset.index);
        const card = this.getCardFromSource(sourceType, sourceCol, sourceIndex);

        if (!card) return;

        let success = false;

        if (targetType === 'foundation') {
          const suit = target.dataset.suit;
          success = this.moveToFoundation(card, suit, sourceType, sourceCol, sourceIndex);
        } else if (targetType === 'tableau') {
          const targetCol = parseInt(target.dataset.column);
          success = this.moveToTableau(card, targetCol, sourceType, sourceCol, sourceIndex);
        }

        if (success) {
          this.moves++;
          this.score += 5;
          this.updateStats();
          this.renderGame();
          this.checkWinCondition();
        }

        this.draggedCard = null;
      }

      getCardFromSource(sourceType, col, index) {
        if (sourceType === 'waste') {
          return this.waste[this.waste.length - 1];
        } else if (sourceType === 'tableau') {
          return this.tableau[col][index];
        } else if (sourceType === 'foundation') {
          const suit = col; // –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ col —Å–æ–¥–µ—Ä–∂–∏—Ç suit
          return this.foundations[suit][index];
        }
        return null;
      }

      moveToFoundation(card, suit, sourceType, sourceCol, sourceIndex) {
        if (card.suit !== suit) return false;

        const foundation = this.foundations[suit];
        if (foundation.length === 0) {
          if (card.rank === 'A') {
            this.removeCardFromSource(sourceType, sourceCol, sourceIndex);
            foundation.push(card);
            this.showCompliment();
            return true;
          }
        } else {
          const topCard = foundation[foundation.length - 1];
          if (this.getRankValue(card.rank) === this.getRankValue(topCard.rank) + 1) {
            this.removeCardFromSource(sourceType, sourceCol, sourceIndex);
            foundation.push(card);
            this.showCompliment();
            return true;
          }
        }
        return false;
      }

      moveToTableau(card, targetCol, sourceType, sourceCol, sourceIndex) {
        const targetPile = this.tableau[targetCol];

        if (targetPile.length === 0) {
          if (card.rank === 'K') {
            this.removeCardFromSource(sourceType, sourceCol, sourceIndex);
            targetPile.push(card);
            this.flipTopCard(sourceType, sourceCol);
            return true;
          }
        } else {
          const topCard = targetPile[targetPile.length - 1];
          const differentColor = this.isRed(card) !== this.isRed(topCard);
          const rankValid = this.getRankValue(card.rank) === this.getRankValue(topCard.rank) - 1;

          if (differentColor && rankValid) {
            this.removeCardFromSource(sourceType, sourceCol, sourceIndex);
            targetPile.push(card);
            this.flipTopCard(sourceType, sourceCol);
            return true;
          }
        }
        return false;
      }

      removeCardFromSource(sourceType, col, index) {
        if (sourceType === 'waste') {
          this.waste.pop();
        } else if (sourceType === 'tableau') {
          this.tableau[col].splice(index, 1);
        } else if (sourceType === 'foundation') {
          const suit = col;
          this.foundations[suit].pop();
        }
      }

      flipTopCard(sourceType, col) {
        if (sourceType === 'tableau') {
          const pile = this.tableau[col];
          if (pile.length > 0 && !pile[pile.length - 1].faceUp) {
            pile[pile.length - 1].faceUp = true;
          }
        }
      }

      isRed(card) {
        return card.suit === 'hearts' || card.suit === 'diamonds';
      }

      getRankValue(rank) {
        const values = {
          'A': 1, '2': 2, '3': 3, '4': 4, '5': 5, '6': 6,
          '7': 7, '8': 8, '9': 9, '10': 10, 'J': 11, 'Q': 12, 'K': 13
        };
        return values[rank];
      }

      dealFromStock() {
        if (this.stock.length > 0) {
          const card = this.stock.pop();
          card.faceUp = true;
          this.waste.push(card);
          this.moves++;
          this.updateStats();
          this.renderStock();
          this.renderWaste();
        } else {
          // –ü–µ—Ä–µ–º–µ—â–∞–µ–º –∫–∞—Ä—Ç—ã –∏–∑ —Å–±—Ä–æ—Å–∞ –æ–±—Ä–∞—Ç–Ω–æ –≤ —Å—Ç–æ–∫
          this.stock = [...this.waste.reverse()];
          this.waste = [];
          this.stock.forEach(card => card.faceUp = false);
          this.moves++;
          this.updateStats();
          this.renderStock();
          this.renderWaste();
        }
      }

      showHint() {
        // –ü—Ä–æ—Å—Ç–∞—è –ø–æ–¥—Å–∫–∞–∑–∫–∞ - –Ω–∞—Ö–æ–¥–∏–º –≤–æ–∑–º–æ–∂–Ω—ã–π —Ö–æ–¥
        this.showCompliment();
      }

      undoMove() {
        // –ë–∞–∑–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç–º–µ–Ω—ã —Ö–æ–¥–∞
        this.showCompliment();
      }

      startTimer() {
        this.startTime = new Date();
        this.timerInterval = setInterval(() => {
          this.updateTime();
        }, 1000);
      }

      updateTime() {
        const now = new Date();
        const diff = Math.floor((now - this.startTime) / 1000);
        const minutes = Math.floor(diff / 60).toString().padStart(2, '0');
        const seconds = (diff % 60).toString().padStart(2, '0');
        document.getElementById('time').textContent = `${minutes}:${seconds}`;
      }

      showCompliment() {
        const randomCompliment = this.compliments[Math.floor(Math.random() * this.compliments.length)];
        const message = document.getElementById('complimentMessage');
        const text = document.getElementById('complimentText');

        text.textContent = randomCompliment;
        message.classList.add('show');

        setTimeout(() => {
          message.classList.remove('show');
        }, 2000);
      }

      checkWinCondition() {
        const allFoundationsFull = this.suits.every(suit =>
          this.foundations[suit].length === 13
        );

        if (allFoundationsFull) {
          this.showWinMessage();
        }
      }

      showWinMessage() {
        clearInterval(this.timerInterval);

        const winMessage = document.getElementById('winMessage');
        const winTime = document.getElementById('winTime');
        const winMoves = document.getElementById('winMoves');

        winTime.textContent = document.getElementById('time').textContent;
        winMoves.textContent = this.moves;

        winMessage.style.display = 'block';
      }

      restartGame() {
        clearInterval(this.timerInterval);
        this.moves = 0;
        this.score = 0;
        this.tableau = [[], [], [], [], [], [], []];
        this.foundations = { hearts: [], diamonds: [], clubs: [], spades: [] };
        this.stock = [];
        this.waste = [];
        this.selectedCards = [];
        this.moveHistory = [];
        this.draggedCard = null;

        this.createDeck();
        this.shuffleDeck();
        this.dealCards();
        this.renderGame();
        this.startTimer();
        this.updateStats();
      }

      updateStats() {
        document.getElementById('moves').textContent = this.moves;
        document.getElementById('score').textContent = this.score;
      }
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ DOM
    document.addEventListener('DOMContentLoaded', () => {
      new SolitaireGame();
    });

    // –î–æ–±–∞–≤—å—Ç–µ —ç—Ç–æ—Ç –∫–æ–¥ –≤ –∫–æ–Ω–µ—Ü —Å–∫—Ä–∏–ø—Ç–∞ SolitaireGame, –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã–≤–∞—é—â–∏–º —Ç–µ–≥–æ–º

    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
    function setupMobileScaling() {
      const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);

      if (isMobile) {
        const viewport = document.querySelector('meta[name="viewport"]');
        if (viewport) {
          viewport.setAttribute('content', 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no');
        }

        // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ zoom –ø—Ä–∏ –¥–≤–æ–π–Ω–æ–º —Ç–∞–ø–µ
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function (event) {
          const now = (new Date()).getTime();
          if (now - lastTouchEnd <= 300) {
            event.preventDefault();
          }
          lastTouchEnd = now;
        }, false);
      }
    }

    // –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞—Å–∞–Ω–∏–π –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
    function setupTouchHandlers() {
      let startX, startY;
      let currentCard = null;

      document.addEventListener('touchstart', function (e) {
        const card = e.target.closest('.card.face-up');
        if (card) {
          currentCard = card;
          startX = e.touches[0].clientX;
          startY = e.touches[0].clientY;

          // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É –æ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–∏
          card.style.transform = 'scale(1.05)';
        }
      }, { passive: true });

      document.addEventListener('touchend', function (e) {
        if (currentCard) {
          currentCard.style.transform = '';
          currentCard = null;
        }
      }, { passive: true });
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ DOM
    document.addEventListener('DOMContentLoaded', () => {
      setupMobileScaling();
      setupTouchHandlers();
      new SolitaireGame();
    });
  </script>
</body>

</html>